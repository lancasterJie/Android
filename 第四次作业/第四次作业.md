# Android第四次作业

## 一、实验目的
通过本实验，掌握Android中三种常用本地数据存储方式：
1. **文件（File）读写**：使用`openFileInput`/`openFileOutput`进行文本文件的保存与加载
2. **SharedPreferences**：使用`getSharedPreferences()`保存和读取键值对配置数据
3. **SQLite数据库**：使用`SQLiteOpenHelper`管理数据库，完成基本CRUD操作

## 二、实验内容与功能实现

### 2.1 文件读写模块实现
在主界面提供多行文本框和两个操作按钮，实现文本的保存与加载功能。

**功能实现要点：**
- 使用`openFileOutput("note.txt", MODE_PRIVATE)`创建/写入文件
- 使用`openFileInput("note.txt")`读取文件内容
- 添加文件不存在异常处理，使用Toast提示用户
- 文本内容保存到应用私有目录，保证数据安全性

**实现效果：**
- 用户在EditText中输入文本，点击"保存到文件"按钮，内容写入`note.txt`
- 点击"从文件加载"按钮，从`note.txt`读取文本并显示到EditText中
- 文件不存在时显示友好提示信息
![当文件不存在时弹出提示](link_to_image1.png)
![将输入的信息写入文件](link_to_image1.png)
![将文件中的内容读取出来](link_to_image1.png)


### 2.2 设置模块实现（SharedPreferences）
设置界面包含配置选项和用户信息输入功能。

**功能实现要点：**
- 使用`getSharedPreferences("settings", MODE_PRIVATE)`获取SharedPreferences实例
- 通过`SharedPreferences.Editor`进行数据写入操作
- 设置界面打开时自动加载已保存配置
- 主界面`onResume()`中读取用户名并更新标题栏

**核心功能：**
1. **自动保存开关**：控制返回主界面时是否自动保存文件
2. **用户信息存储**：保存用户名和密码信息
3. **配置持久化**：应用重启后配置信息自动恢复
4. **自动保存逻辑**：当自动保存开启时，返回主界面自动调用文件保存功能

![输入账户信息不勾选自动保存](link_to_image2.png)
![不勾选自动保存主界面不更新标题栏](link_to_image2.png)
![输入账户信息并勾选自动保存](link_to_image2.png)
![主界面标题栏进行更新](link_to_image2.png)
![从主界面进入设置界面时账户信息自动填充](link_to_image2.png)


### 2.3 数据库模块实现（SQLite）
数据库模块包含记录管理、列表展示和详情查看功能。

#### 2.3.1 数据库设计
设计records表结构：
- `_id`：整数主键，自增
- `title`：文本，记录标题
- `content`：文本，记录内容
- `time`：文本，记录创建时间

![数据库记录类结构](link_to_image3.png)

#### 2.3.2 SQLiteOpenHelper实现
创建MyDbHelper类继承SQLiteOpenHelper：
- 数据库名称：`myapp.db`
- 版本号：1
- 在`onCreate()`中创建records表
- 在`onUpgrade()`中实现表更新逻辑

![MyDbHelper类](link_to_image3.png)

#### 2.3.3 功能实现
1. **新增记录**：
   - 主界面添加"保存为记录"按钮
   - 将当前EditText内容保存为数据库记录
   - 标题自动截取内容前几个字符
   - 时间自动记录当前时间戳
![新增记录功能](link_to_image3.png)

2. **记录列表展示**：
   - 使用ListView或RecyclerView展示所有记录
   - 每条记录显示标题和创建时间
   - 点击列表项跳转到详情界面
![保存的记录显示在记录列表界面](link_to_image3.png)


3. **查看详情**：
   - 详情界面显示记录的完整内容
   - 支持返回列表操作
![记录详情界面](link_to_image4.png)

4. **额外功能（加分项）**：
   - 支持删除记录：长按列表项弹出删除选项
   - 支持编辑记录：点击编辑按钮进入编辑模式
![删除记录功能](link_to_image4.png)
![编辑记录](link_to_image4.png)
![编辑的记录已更新](link_to_image4.png)


## 三、界面设计与交互

### 3.1 菜单设计
- 使用OptionsMenu或Toolbar添加导航菜单
- 菜单项：设置、记录列表
- 点击相应菜单项跳转到对应Activity
![通过菜单进行Activity的跳转](link_to_image4.png)


## 四、实验总结

### 4.1 掌握的知识点
通过本次实验，掌握了以下Android开发技能：

1. **文件存储技术**
   - 内部存储文件读写操作
   - 异常处理机制
   - 数据持久化原理

2. **SharedPreferences应用**
   - 配置信息的保存与读取
   - 轻量级数据存储方案
   - 自动保存功能实现

3. **SQLite数据库操作**
   - 数据库设计与创建
   - CRUD操作实现
   - 数据列表展示
   - 详情查看功能

4. **多界面交互**
   - Activity之间的跳转与数据传递
   - 菜单导航实现
   - 用户界面友好设计

### 4.2 实验收获
1. **理解了不同存储方式的适用场景**
   - 文件存储：适合大文本、二进制数据
   - SharedPreferences：适合简单配置信息
   - SQLite：适合结构化数据管理

2. **掌握了完整的Android数据持久化方案**
   - 从简单到复杂的数据存储需求都能应对
   - 学会了根据数据类型选择合适的存储方式

3. **提升了综合应用开发能力**
   - 多模块协同开发
   - 异常处理和用户体验优化
   - 代码组织和架构设计
