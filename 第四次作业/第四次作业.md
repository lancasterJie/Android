# **Android 本地数据持久化综合实验报告**

## **一、实验目的**



1. 掌握 Android 平台下文件（File）读写的基本方法，能够使用 FileInputStream/FileOutputStream 或 openFileInput/openFileOutput 实现文本内容的本地存储与加载。

2. 理解 SharedPreferences 的工作原理，学会使用其进行简单键值对数据（如配置信息、账户密码）的保存与读取。

3. 熟悉 SQLite 数据库在 Android 中的应用，能够通过 SQLiteOpenHelper 实现数据库的创建、升级及增删改查（CRUD）操作。

4. 综合运用三种数据持久化方式，设计并实现具有实际功能的 Android 应用，理解不同存储方式的适用场景。

## **二、实验内容设计**

### （1）文件读写模块

#### 保存：使用 openFileOutput 获取输出流，将文本内容转换为字节数组写入。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_b892fc0d-2585-459d-9093-1a43703e505e.png~tplv-a9rns2rl98-image-qvalue.png?rcl=202512022030560E03393B835AE51507B2\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301057\&x-signature=1njy6KI3%2BR6HciLShC5KhzMwKeI%3D)

#### 加载：使用 openFileInput 获取输入流，读取字节数据并转换为字符串。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_654d80a5-dfc8-46c0-b68a-9923bae2f120.png~tplv-a9rns2rl98-image-qvalue.png?rcl=20251202203014E16B83EF5442D6FE8747\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301014\&x-signature=tTB4zvd6yGLpOW013JM%2B7bL8ndA%3D)

#### 异常处理：针对文件不存在、IO 错误等情况捕获异常，并通过 Toast 提示用户。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_007bdf07-a359-486a-9bb6-c1eb93784ea9.png~tplv-a9rns2rl98-image-qvalue.png?rcl=202512022032011732645EE0427D8274B6\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301121\&x-signature=x9z0cFV2%2FYrhYrBHuYHqXNUYJ6s%3D)

### （2）SharedPreferences 模块

#### 写入：通过 Editor 存储布尔值（自动保存开关）和字符串（用户名、密码）。

#### 读取：在 SettingsActivity 初始化时加载配置并更新 UI；在 MainActivity 的 onResume () 中读取用户名并更新标题。

使用 ：`getSharedPreferences("settings", MODE_PRIVATE)` 获取 SharedPreferences 实例。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_8566fce5-7e00-4a74-be72-8124df1e495a.png~tplv-a9rns2rl98-image-qvalue.png?rcl=20251202203253071C9E2436D6C69A9221\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301174\&x-signature=NvS9QK9cpNT2kXBSIOJRYzWZFTg%3D)

### （3）SQLite 数据库模块

#### 核心功能

实现多条记事本记录的持久化存储，支持新增、查询、查看详情（及可选的删除、编辑）。

#### 实现思路

**数据库设计**：创建 records 表，包含字段 \_id（主键自增）、title（标题）、content（内容）、time（时间戳）。

**帮助类**：自定义 DatabaseHelper 继承 SQLiteOpenHelper，实现数据库创建与升级逻辑。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_a8976e11-946c-43df-9181-680b28706764.png~tplv-a9rns2rl98-image-qvalue.png?rcl=202512022033460109A20D62FB531B04E6\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301226\&x-signature=zZBiTlhq23CDOknq9FDuA1%2F5fu0%3D)



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_dd729915-5954-442d-8803-e62d799065ef.png~tplv-a9rns2rl98-image-qvalue.png?rcl=20251202203447819C14403911A7BC826B\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301287\&x-signature=RJxsxu8dmyRfth3mX6xKWkHPGB8%3D)

**功能实现**



* 新增：将 MainActivity 中的文本内容按 “标题（前 N 字）+ 全文 + 当前时间” 格式插入数据库。

* 列表展示：在 RecordListActivity 中通过 ListView 或 RecyclerView 展示所有记录的标题和时间。

* 详情查看：点击列表项跳转至详情页，显示完整内容。

## **三、实验结果与分析**

### 功能测试结果



1. **文件读写功能**

* 截图 1：点击 “保存到文件” 后，文本内容成功写入 note.txt 的验证（可通过 Android Studio 的 Device File Explorer 查看文件内容）。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_e6ae3381-f24a-4362-8028-7c66825b5667.png~tplv-a9rns2rl98-image-qvalue.png?rcl=20251202203520B158CF0BA4095A09894C\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301321\&x-signature=BWL%2BTTkowyY83weOwfGUwQV7DUw%3D)



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_037d18d2-6545-44cf-ab84-771df4d6868f.png~tplv-a9rns2rl98-image-qvalue.png?rcl=20251202203558579643D055244D1CE304\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301358\&x-signature=l64ISyOhbUu0GfnMDD0OVHsqa7k%3D)



* 截图 2：点击 “从文件加载” 后，文本内容正确显示在 EditText 中的界面（同 “加载” 模块插入的图片）。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_a96c531c-7524-4bac-a64c-9d72c1ae9017.png~tplv-a9rns2rl98-image-qvalue.png?rcl=202512022036227238050D9D8957C9FBB2\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301382\&x-signature=%2F%2FtdIJSqxPvELYsdZQIhhQ%2FIhV4%3D)



1. **SharedPreferences 功能**

* 截图 3：SettingsActivity 中配置用户名、密码并开启自动保存的界面（同 “写入” 模块插入的图片）。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_5c0834c6-305b-44ed-9e24-37287aa73c10.png~tplv-a9rns2rl98-image-qvalue.png?rcl=20251202203646545E796DFCA6EEC76082\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301406\&x-signature=Xb6YzLltGO7s9q0HS3dkPHYmuTo%3D)



* 界面信息：用户设置、自动保存到文件、用户名（lzd）、密码（隐藏显示）、保存设置按钮、登录按钮、“设置已保存” 提示。

1. **SQLite 数据库功能**

* 截图 4：新增记录成功插入数据库的日志或界面反馈（界面显示 “保存到文件”“加载成功”“从文件加载” 等按钮及状态提示）。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_c4826d8c-c361-49e4-85d6-dd9d96f83507.png~tplv-a9rns2rl98-image-qvalue.png?rcl=2025120220371936B3C481D7C60A2C52A4\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301439\&x-signature=Ss8pk%2Fcrdl9tMUBKRp7LENTfXBk%3D)



* 截图 5：RecordListActivity 中展示所有记录的列表界面（同 “列表展示” 模块插入的图片）。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_ffeca5ed-c8c8-4bbd-bb70-1bb4c812e3f4.png~tplv-a9rns2rl98-image-qvalue.png?rcl=20251202203803AF1251515EF33281EA4A\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301483\&x-signature=maYJxZJtpDXH9xDTgatr4eZx7JQ%3D)



* 截图 6：点击列表项后显示记录详情的界面（同 “详情查看” 模块插入的图片）。



![](https://p3-flow-imagex-sign.byteimg.com/ocean-cloud-tos/pages_upload_image_da9157d7-f624-412f-8d8e-a89387a6be9f.png~tplv-a9rns2rl98-image-qvalue.png?rcl=20251202203832B06CEDEDD2C1D865A23D\&rk3s=8e244e95\&rrcfp=121e9355\&x-expires=1796301512\&x-signature=KFKIOUUHi8BRHQQH3%2Fru198UjZE%3D)

> （注：文档部分内容可能由 AI 生成）