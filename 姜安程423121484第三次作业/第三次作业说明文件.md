# Android Fragment切换与数据传输项目说明

## 项目概述

本项目是一个综合性的Android应用，完整实现了Fragment切换、Bundle数据传递和状态保存三个核心功能模块。通过RadioGroup控制Fragment导航，展示了Activity与Fragment之间多种数据传递方式，并实现了屏幕旋转时的状态保存机制。

## 项目结构

### 主要组件

`text`

`MainActivity.java  # 主Activity，管理Fragment切换和数据传递`

`DetailActivity.java  # 详情页面，展示接收的数据`

``

`#Fragment组件`

`HomeFragment.java  # 首页Fragment`

`ProfileFragment.java  # 个人资料Fragment`

`SettingsFragment.java  # 设置Fragment（含回调接口）`

`AboutFragment.java  # 关于页面Fragment`



## 功能实现详情

### 1. RadioGroup控制Fragment切换

#### 实现效果

* 底部RadioGroup包含4个RadioButton：首页、个人资料、设置、关于

* 点击RadioButton切换到对应的Fragment

* 每个Fragment具有独特的UI和功能

#### 核心代码

`java`

`// MainActivity.java中的切换逻辑`

`radioGroup.setOnCheckedChangeListener((group,checkedId) -> {`

`Fragment fragment = null;`



`if (checkedId == R.id.radioHome) {`

`fragment = HomeFragment.newInstance("张三"); // 传递初始数据`

` }else if (checkedId == R.id.radioProfile) {`

`fragment = new ProfileFragment();`

`} else if (checkedId == R.id.radioSettings){`

` fragment = new SettingsFragment();`

`} else if (checkedId == R.id.radioAbout) {`

`fragment = new AboutFragment();`

` }`



`// Fragment切换`

`getSupportFragmentManager().beginTransaction()`

` .replace(R.id.fragmentContainer, fragment)`

` .commit();`

`});`



### 2. Bundle数据传输三种场景

#### 场景A: Activity → Activity

**MainActivity → DetailActivity**

`java`

`// MainActivity.java`

`private void startDetailActivity() {`

` Intent intent = new Intent(this,DetailActivity.class);`

`Bundle bundle = new Bundle();`

`bundle.putString("USER_NAME","张三");`

`bundle.putInt("USER_AGE", 25);`

`bundle.putBoolean("IS_STUDENT",true);`

` intent.putExtras(bundle);`

`startActivity(intent);`

`}`



`// DetailActivity.java - 接收并展示数据`

`Bundle bundle = getIntent().getExtras();`

`if (bundle != null) {`

`String userName =bundle.getString("USER_NAME", "未知");`

` intuserAge = bundle.getInt("USER_AGE", 0);`

`boolean isStudent =bundle.getBoolean("IS_STUDENT", false); // 显示数据...`

`}`



#### 场景B: Activity ↔ Fragment

**Activity → Fragment（传递初始数据）**

`java`

`// MainActivity.java`

`fragment = HomeFragment.newInstance("张三"); // 通过newInstance工厂方法传递`



`// HomeFragment.java`

`public static HomeFragmentnewInstance(String username) {`

`HomeFragment fragment = new HomeFragment();`

`Bundle args = new Bundle();`

` args.putString(ARG_USERNAME, username); //"username"键存储 fragment.setArguments(args);`

`return fragment;`

`}`



`// Fragment接收数据`

`if (getArguments() != null) {`

`username =getArguments().getString(ARG_USERNAME, "用户");`

` tvWelcome.setText("欢迎，" + username + "！");`

`}`



**Fragment → Activity（返回处理结果）**

`java`

`// HomeFragment.java - 发送数据给Activity`

`btnSendToActivity.setOnClickListener(v-> {`

` if(getActivity() instanceof MainActivity) {`

` ((MainActivity)getActivity()).onFragmentResult(`

`"来自HomeFragment的处理结果：" + System.currentTimeMillis()`

` );`

` }`

`});`



`// MainActivity.java - 接收Fragment结果public voidonFragmentResult(String result) { Toast.makeText(this, "收到Fragment结果: " + result,Toast.LENGTH_SHORT).show();`

`fragmentData = result; // 保存数据`

`}`



#### 场景C: Fragment → Fragment（通过Activity中转）

`java`

`// SettingsFragment.java - 定义回调接口`

`public interface OnSettingChangeListener {`

`void onSettingChanged(String setting);`

`}`



`// SettingsFragment发送数据`

`btnSendToOtherFragment.setOnClickListener(v-> {`

` if(listener != null) {`

`listener.onSettingChanged("设置已更新: " + System.currentTimeMillis());

 }});`



`// MainActivity实现接口接收并中转`

`@Override`

`public void onSettingChanged(Stringsetting) {`

`Toast.makeText(this, "设置变更: " + setting, Toast.LENGTH_SHORT).show();`

`fragmentData = setting;`



` // 可以传递给其他Fragment`

` AboutFragment aboutFragment = newAboutFragment();`

` Bundle args = new Bundle();`

`args.putString("SETTING_UPDATE",setting);`

`aboutFragment.setArguments(args);

}`



### 3. 屏幕旋转与状态保存

#### 生命周期观察

* **日志输出位置**：`onSaveInstanceState` 在 `onStop()` 之前、`onPause()` 之后调用

* 通过Log.d("Lifecycle","onSaveInstanceState")验证调用时机

#### 状态保存与恢复

`java`

`// 保存状态`

`@Override`

`protected void onSaveInstanceState(@NonNullBundle outState) {`

`    super.onSaveInstanceState(outState);`

`    Log.d("Lifecycle", "onSaveInstanceState - 在onStop之前，onPause之后调用");`

`    // 保存EditText内容`

`    String inputText = etInput.getText().toString();`

`    outState.putString("SAVED_TEXT", inputText);`

`    outState.putString("FRAGMENT_DATA", fragmentData);`

`}`



`// 恢复状态（两种方式）`

`@Override`

`protected void onCreate(BundlesavedInstanceState) {`

`    super.onCreate(savedInstanceState);`

`    // ... 其他初始化`

`    if (savedInstanceState != null) {`

`        String savedText = savedInstanceState.getString("SAVED_TEXT","");`

`        tvSavedData.setText("恢复的数据: " +savedText);`

`        fragmentData = savedInstanceState.getString("FRAGMENT_DATA","");`

`    }`

`}`



`@Override`

`protected voidonRestoreInstanceState(@NonNull Bundle savedInstanceState) {`

`    super.onRestoreInstanceState(savedInstanceState);`

`    Log.d("Lifecycle", "onRestoreInstanceState");`

`    String savedText = savedInstanceState.getString("SAVED_TEXT");`

`    if (savedText != null && !savedText.isEmpty()) {`

`        tvSavedData.setText("恢复的数据: " +savedText);`

`    }`

`}

`

## 学习要点

通过本项目可以掌握：

1. Android Fragment管理与切换

2. Bundle数据传递的多种应用场景

3. Activity生命周期与状态保存

4. 组件间通信的设计模式

5. 接口回调的实际应用
