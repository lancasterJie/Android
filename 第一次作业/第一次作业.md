# Android第一次实验报告

## 第一部分：显式跳转

### 一、从MainActivity通过"跳转到SecondActivity"按钮显式跳转到SecondActivity

#### （1）实现步骤
首先创建好MainActivity和SecondActivity，再在`activity_main.xml`文件中添加"跳转到SecondActivity"按钮，最后在`MainActivity.java`文件中为按钮设置监听器即可实现该功能。

**activity_main.xml 代码：**
```xml
<Button
    android:id="@+id/btnJumpToSecond"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="跳转到SecondActivity" />
```

**MainActivity.java 代码：**
```java
Button btnJumpToSecond = findViewById(R.id.btnJumpToSecond);
btnJumpToSecond.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        Intent intent = new Intent(MainActivity.this, SecondActivity.class);
        startActivity(intent);
    }
});
```

#### （2）运行结果截图

[显示跳转](media/image3.png)

---

### 二、在SecondActivity中添加"返回到主页"按钮返回到MainActivity

#### （1）实现步骤
首先在`activity_second.xml`文件中添加一个名为"返回到主页"的按钮，再在`SecondActivity.java`文件中为该按钮设置监听器。

**activity_second.xml 代码：**
```xml
<Button
    android:id="@+id/btnBackToMain"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="返回到主页" />
```

**SecondActivity.java 代码：**
```java
Button btnBackToMain = findViewById(R.id.btnBackToMain);
btnBackToMain.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        finish(); // 结束当前Activity，返回到上一个Activity
    }
});
```

#### （2）运行结果截图

[返回主页按钮]()

---

## 第二部分：隐式跳转

### 在SecondActivity中添加"隐式跳转"按钮跳转到ThirdActivity

#### （1）实现步骤
1. 首先创建好ThirdActivity
2. 在 `AndroidManifest.xml` 文件中，为 ThirdActivity 的`<activity>`标签添加一个`<intent-filter>`：
   - action为`"com.example.action.VIEW_THIRD_ACTIVITY"`
   - category为`"android.intent.category.DEFAULT"`
   - 把`android:exported`修改为`"true"`
3. 在`activity_second.xml`文件中添加一个名为"隐式跳转"的按钮
4. 在`SecondActivity.java`文件中为该按钮设置监听器

**AndroidManifest.xml 代码：**
```xml
<activity
    android:name=".ThirdActivity"
    android:exported="true">
    <intent-filter>
        <action android:name="com.example.action.VIEW_THIRD_ACTIVITY" />
        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
</activity>
```

**activity_second.xml 代码：**
```xml
<Button
    android:id="@+id/btnImplicitJump"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="隐式跳转" />
```

**SecondActivity.java 代码：**
```java
Button btnImplicitJump = findViewById(R.id.btnImplicitJump);
btnImplicitJump.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        Intent intent = new Intent();
        intent.setAction("com.example.action.VIEW_THIRD_ACTIVITY");
        startActivity(intent);
    }
});
```

#### （2）运行结果截图

[隐式跳转](media/image10.png)

---

## 第三部分：带返回结果的跳转

### 在MainActivity中点击"启动带结果的跳转"按钮跳转到ThirdActivity，将结果返回到MainActivity的TextView

#### （1）实现步骤
1. 在`activity_main.xml`中添加一个名为"启动带结果的跳转"的按钮以及一个显示返回结果的TextView
2. 在`MainActivity.java`中为该按钮设置事件监听器，使用`startActivityForResult()`方法，并为该跳转设置唯一的请求码101
3. 在`activity_Third.xml`文件添加一个名为"返回结果"的按钮和一个EditText
4. 在`ThirdActivity.java`文件中为该按钮设置点击事件，设置唯一的结果码为`ThirdActivity.RESULT_OK`并使用`finish()`方法结束当前Activity
5. 在`MainActivity.java`中重写`onActivityResult(int requestCode, int resultCode, Intent data)`方法

**activity_main.xml 部分代码：**
```xml
<Button
    android:id="@+id/btnStartForResult"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="启动带结果的跳转" />

<TextView
    android:id="@+id/tvResult"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="等待返回结果..." />
```

**MainActivity.java 部分代码：**
```java
private static final int REQUEST_CODE = 101;
private TextView tvResult;

// 按钮点击事件
Button btnStartForResult = findViewById(R.id.btnStartForResult);
btnStartForResult.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        Intent intent = new Intent(MainActivity.this, ThirdActivity.class);
        startActivityForResult(intent, REQUEST_CODE);
    }
});

tvResult = findViewById(R.id.tvResult);

// 重写onActivityResult方法
@Override
protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == REQUEST_CODE) {
        if (resultCode == Activity.RESULT_OK && data != null) {
            String result = data.getStringExtra("result");
            tvResult.setText("返回结果: " + result);
        } else if (resultCode == Activity.RESULT_CANCELED) {
            tvResult.setText("用户取消了操作");
        }
    }
}
```

**activity_third.xml 部分代码：**
```xml
<EditText
    android:id="@+id/etInput"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:hint="请输入返回内容" />

<Button
    android:id="@+id/btnReturnResult"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="返回结果" />
```

**ThirdActivity.java 部分代码：**
```java
Button btnReturnResult = findViewById(R.id.btnReturnResult);
btnReturnResult.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        EditText etInput = findViewById(R.id.etInput);
        String input = etInput.getText().toString();
        
        Intent resultIntent = new Intent();
        resultIntent.putExtra("result", input);
        setResult(Activity.RESULT_OK, resultIntent);
        finish();
    }
});
```

#### （2）运行结果截图

| MainActivity界面 | ThirdActivity界面 | 返回结果界面 |
|----------------|-----------------|------------|
| [带返回结果的跳转1](media/image16.png) | [带返回结果的跳转2](media/image17.png) |[带返回结果的跳转3](media/image18.png) |

---

## 第四部分：长按监听器

#### （1）实现步骤
在`MainActivity.java`中为"启动带结果的跳转"按钮添加一个长按监听器，使用Toast的`makeText()`方法设置提示信息。

**MainActivity.java 部分代码：**
```java
Button btnStartForResult = findViewById(R.id.btnStartForResult);

// 长按监听器
btnStartForResult.setOnLongClickListener(new View.OnLongClickListener() {
    @Override
    public boolean onLongClick(View v) {
        Toast.makeText(MainActivity.this, 
                      "长按事件：将启动带返回结果的Activity跳转", 
                      Toast.LENGTH_SHORT).show();
        return true; // 返回true表示已处理该事件
    }
});
```

#### （2）运行结果截图

[长按监听器](media/image21.png)

---

## 第五部分：取消操作

#### （1）实现步骤
1. 在`activity_third.xml`文件添加一个名为"返回取消"的按钮
2. 在`ThirdActivity.java`文件设置它的点击事件，使用`setResult()`方法设置一个结果码并使用`finish()`方法结束当前activity
3. 重写`MainActivity.java`文件中的`onActivityResult()`方法处理取消操作

**activity_third.xml 部分代码：**
```xml
<Button
    android:id="@+id/btnCancel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="返回取消" />
```

**ThirdActivity.java 部分代码：**
```java
Button btnCancel = findViewById(R.id.btnCancel);
btnCancel.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        setResult(Activity.RESULT_CANCELED);
        finish();
    }
});
```

**MainActivity.java 部分代码：**
```java
@Override
protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == REQUEST_CODE) {
        if (resultCode == Activity.RESULT_OK && data != null) {
            String result = data.getStringExtra("result");
            tvResult.setText("返回结果: " + result);
        } else if (resultCode == Activity.RESULT_CANCELED) {
            tvResult.setText("用户取消了操作");
        }
    }
}
```

#### （2）运行结果截图

[取消操作](media/image25.png)

---

## 实验总结

通过本次实验，我掌握了：

1. **显式跳转**：通过指定目标Activity类名进行跳转
2. **隐式跳转**：通过Intent的Action和Category进行匹配跳转
3. **带返回结果的跳转**：使用`startActivityForResult()`和`onActivityResult()`方法
4. **长按监听器**：为控件添加`OnLongClickListener`处理长按事件
5. **取消操作处理**：正确处理用户取消操作的情况

这些知识为后续Android应用开发打下了坚实的基础，特别是在Activity间通信和数据传递方面。
