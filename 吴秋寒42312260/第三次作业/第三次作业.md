# Android Fragment åˆ‡æ¢ä¸æ•°æ®ä¼ è¾“å®éªŒæŠ¥å‘Šï¼ˆåŸºäºç›®å½•ç»“æ„ä¿®æ”¹ï¼‰

## ä¸€ã€å®éªŒç›®çš„



1. æŒæ¡ä½¿ç”¨ RadioGroup å®ç° Fragment åˆ‡æ¢çš„æ–¹æ³•

2. å­¦ä¼šä½¿ç”¨ Bundle å®ç°ä¸åŒç»„ä»¶é—´çš„æ•°æ®ä¼ è¾“ï¼ˆActivity ä¹‹é—´ã€Activity ä¸ Fragment ä¹‹é—´ã€Fragment ä¹‹é—´ï¼‰

3. ç†è§£å±å¹•æ—‹è½¬æ—¶çš„çŠ¶æ€ä¿å­˜æœºåˆ¶ï¼ŒæŒæ¡ `onSaveInstanceState` çš„ä½¿ç”¨æ–¹æ³•

## äºŒã€å®éªŒç¯å¢ƒ



| ç¯å¢ƒé¡¹            | å…·ä½“é…ç½®                 |
| -------------- | -------------------- |
| å¼€å‘å·¥å…·           | Android Studio       |
| Android SDK ç‰ˆæœ¬ | API 36.0ï¼ˆAndroid 14ï¼‰ |
| è¿è¡Œè®¾å¤‡           | æ¨¡æ‹Ÿå™¨ï¼ˆPixel 8ï¼‰         |
| å¼€å‘è¯­è¨€           | Java + XML           |
| åŒ…å             | `com.example.radio`  |

## ä¸‰ã€å®éªŒå†…å®¹ä¸æ­¥éª¤

### ï¼ˆä¸€ï¼‰ç¬¬ä¸€éƒ¨åˆ†ï¼šRadioGroup æ§åˆ¶ Fragment åˆ‡æ¢

#### æ­¥éª¤ 1ï¼šåˆ›å»º RadioButton èƒŒæ™¯é€‰æ‹©å™¨

#### `radio_button_selector.xml` æ–‡ä»¶ï¼š



```xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_checked="true">
        <shape android:shape="rectangle">
            <solid android:color="#FF5722" />
            <corners android:radius="8dp" />
        </shape>
    </item>
    <item android:state_checked="false">
        <shape android:shape="rectangle">
            <solid android:color="#F5F5F5" />
            <corners android:radius="8dp" />
        </shape>
    </item>
</selector>
```

#### æ­¥éª¤ 2ï¼šåœ¨ `styles.xml` ä¸­å®šä¹‰ RadioButton ç»Ÿä¸€æ ·å¼

æ‰“å¼€ `res/values/styles.xml`ï¼Œæ·»åŠ è‡ªå®šä¹‰æ ·å¼ï¼š



```xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_checked="true">
        <shape android:shape="rectangle">
            <solid android:color="#FF5722" />
            <corners android:radius="8dp" />
        </shape>
    </item>
    <item android:state_checked="false">
        <shape android:shape="rectangle">
            <solid android:color="#F5F5F5" />
            <corners android:radius="8dp" />
        </shape>
    </item>
</selector>
```

åŒæ—¶åœ¨ `res/color` ç›®å½•ä¸‹åˆ›å»º `radio_text_selector.xml`ï¼š



```xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_checked="true" android:color="@android:color/white" />
    <item android:state_checked="false" android:color="@android:color/black" />
</selector>
```

#### æ­¥éª¤ 3ï¼šåˆ›å»º 4 ä¸ª Fragment åŠå…¶å¸ƒå±€

**1. HomeFragment å¸ƒå±€ï¼ˆ**`fragment_home.xml`**ï¼‰**



```xml
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#F5F5F5">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="16dp">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="ğŸ“± é¦–é¡µ"
            android:textSize="28sp"
            android:textColor="#2196F3"
            android:textStyle="bold"
            android:layout_marginBottom="16dp" />

        <!-- æ¬¢è¿å¡ç‰‡ -->
        <androidx.cardview.widget.CardView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="16dp">
            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical"
                android:padding="16dp">
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="æ¬¢è¿ä½¿ç”¨"
                    android:textSize="20sp"
                    android:textStyle="bold" />
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="RadioGroup Fragment æ¼”ç¤ºåº”ç”¨"
                    android:textSize="14sp"
                    android:layout_marginTop="8dp" />
                <Button
                    android:id="@+id/btn_to_detail"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="åœºæ™¯A: è·³è½¬åˆ°è¯¦æƒ…é¡µ"
                    android:layout_marginTop="12dp" />
            </LinearLayout>
        </androidx.cardview.widget.CardView>

        <!-- çŠ¶æ€ä¿å­˜å¡ç‰‡ -->
        <androidx.cardview.widget.CardView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="16dp">
            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical"
                android:padding="16dp">
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="å±å¹•æ—‹è½¬æµ‹è¯•"
                    android:textSize="18sp"
                    android:textStyle="bold" />
                <EditText
                    android:id="@+id/et_input"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:hint="è¾“å…¥å†…å®¹åæ—‹è½¬å±å¹•æµ‹è¯•"
                    android:layout_marginTop="8dp" />
                <TextView
                    android:id="@+id/tv_saved_content"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:text="æ—‹è½¬åå†…å®¹ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ"
                    android:textSize="16sp"
                    android:textColor="#4CAF50"
                    android:layout_marginTop="8dp"
                    android:padding="12dp"
                    android:background="#E8F5E9" />
            </LinearLayout>
        </androidx.cardview.widget.CardView>

    </LinearLayout>
</ScrollView>
```

**HomeFragment ä»£ç **



```java
package com.example.radio;

import android.content.Intent;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import androidx.fragment.app.Fragment;

public class HomeFragment extends Fragment {
    private EditText etInput;
    private TextView tvSavedContent;
    private static final String KEY_SAVED_TEXT = "saved_text";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_home, container, false);

        etInput = view.findViewById(R.id.et_input);
        tvSavedContent = view.findViewById(R.id.tv_saved_content);
        Button btnToDetail = view.findViewById(R.id.btn_to_detail);

        // åœºæ™¯A: Activity â†’ Activity æ•°æ®ä¼ é€’
        btnToDetail.setOnClickListener(v -> {
            Intent intent = new Intent(getActivity(), DetailActivity.class);
            intent.putExtra("username", "å¼ ä¸‰");
            intent.putExtra("age", 20);
            intent.putExtra("isStudent", true);
            startActivity(intent);
        });

        // æ¢å¤ä¿å­˜çš„çŠ¶æ€
        if (savedInstanceState != null) {
            String savedText = savedInstanceState.getString(KEY_SAVED_TEXT);
            if (savedText != null && !savedText.isEmpty()) {
                tvSavedContent.setText("å·²æ¢å¤å†…å®¹ï¼š" + savedText);
                etInput.setText(savedText);
            }
        }

        return view;
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        // ä¿å­˜EditTextä¸­çš„å†…å®¹
        String text = etInput.getText().toString();
        outState.putString(KEY_SAVED_TEXT, text);
        android.util.Log.d("HomeFragment", "onSaveInstanceState: ä¿å­˜äº†å†…å®¹ = " + text);
    }
}

```

**2. DiscoverFragment å¸ƒå±€ï¼ˆ**`fragment_discover.xml`**ï¼‰**



```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:background="#E0F7FA">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="16dp">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="ğŸ” å‘ç°"
            android:textSize="28sp"
            android:textColor="#00BCD4"
            android:textStyle="bold"
            android:layout_marginBottom="16dp" />

        <EditText
            android:id="@+id/et_search"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:hint="ğŸ” æœç´¢å†…å®¹..."
            android:padding="12dp"
            android:background="@android:color/white" />
    </LinearLayout>

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <GridLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:columnCount="2"
            android:padding="8dp">

            <!-- ç½‘æ ¼é¡¹1 -->
            <androidx.cardview.widget.CardView
                android:layout_width="0dp"
                android:layout_height="150dp"
                android:layout_columnWeight="1"
                android:layout_margin="8dp">
                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:orientation="vertical"
                    android:gravity="center"
                    android:background="#FF9800">
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="ğŸ“¸"
                        android:textSize="40sp" />
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="ç…§ç‰‡"
                        android:textColor="@android:color/white"
                        android:textSize="16sp" />
                </LinearLayout>
            </androidx.cardview.widget.CardView>

            <!-- ç½‘æ ¼é¡¹2 -->
            <androidx.cardview.widget.CardView
                android:layout_width="0dp"
                android:layout_height="150dp"
                android:layout_columnWeight="1"
                android:layout_margin="8dp">
                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:orientation="vertical"
                    android:gravity="center"
                    android:background="#E91E63">
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="ğŸµ"
                        android:textSize="40sp" />
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="éŸ³ä¹"
                        android:textColor="@android:color/white"
                        android:textSize="16sp" />
                </LinearLayout>
            </androidx.cardview.widget.CardView>

            <!-- ç½‘æ ¼é¡¹3 -->
            <androidx.cardview.widget.CardView
                android:layout_width="0dp"
                android:layout_height="150dp"
                android:layout_columnWeight="1"
                android:layout_margin="8dp">
                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:orientation="vertical"
                    android:gravity="center"
                    android:background="#9C27B0">
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="ğŸ¬"
                        android:textSize="40sp" />
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="è§†é¢‘"
                        android:textColor="@android:color/white"
                        android:textSize="16sp" />
                </LinearLayout>
            </androidx.cardview.widget.CardView>

            <!-- ç½‘æ ¼é¡¹4 -->
            <androidx.cardview.widget.CardView
                android:layout_width="0dp"
                android:layout_height="150dp"
                android:layout_columnWeight="1"
                android:layout_margin="8dp">
                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:orientation="vertical"
                    android:gravity="center"
                    android:background="#4CAF50">
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="ğŸ“š"
                        android:textSize="40sp" />
                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="æ–‡ç« "
                        android:textColor="@android:color/white"
                        android:textSize="16sp" />
                </LinearLayout>
            </androidx.cardview.widget.CardView>

        </GridLayout>
    </ScrollView>

</LinearLayout>
```

**DiscoverFragment ä»£ç **



```java
package com.example.radio;

import android.os.Bundle;
import android.text.Editable;
import android.text.TextWatcher;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.EditText;
import android.widget.Toast;
import androidx.fragment.app.Fragment;

public class DiscoverFragment extends Fragment {
    
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_discover, container, false);
        
        EditText etSearch = view.findViewById(R.id.et_search);
        
        // æ·»åŠ æœç´¢åŠŸèƒ½
        etSearch.addTextChangedListener(new TextWatcher() {
            @Override
            public void beforeTextChanged(CharSequence s, int start, int count, int after) {}

            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                if (s.length() > 0) {
                    Toast.makeText(getContext(), "æ­£åœ¨æœç´¢: " + s, Toast.LENGTH_SHORT).show();
                }
            }

            @Override
            public void afterTextChanged(Editable s) {}
        });
        
        return view;
    }
}
```

**3. MessageFragment å¸ƒå±€ï¼ˆ**`fragment_message.xml`**ï¼‰**



```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:background="#FCE4EC">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="ğŸ’¬ æ¶ˆæ¯"
        android:textSize="28sp"
        android:textColor="#E91E63"
        android:textStyle="bold"
        android:padding="16dp" />

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:padding="16dp">

            <!-- æ¶ˆæ¯é¡¹1 -->
            <androidx.cardview.widget.CardView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="12dp">
                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:orientation="horizontal"
                    android:padding="12dp">
                    <TextView
                        android:layout_width="40dp"
                        android:layout_height="40dp"
                        android:text="ğŸ‘¤"
                        android:textSize="30sp"
                        android:gravity="center" />
                    <LinearLayout
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:layout_weight="1"
                        android:orientation="vertical"
                        android:layout_marginLeft="12dp">
                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="å¼ ä¸‰"
                            android:textSize="16sp"
                            android:textStyle="bold" />
                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="ä½ å¥½ï¼Œæœ€è¿‘æ€ä¹ˆæ ·ï¼Ÿ"
                            android:textSize="14sp"
                            android:layout_marginTop="4dp" />
                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="10:30"
                            android:textSize="12sp"
                            android:textColor="#999999"
                            android:layout_marginTop="4dp" />
                    </LinearLayout>
                    <TextView
                        android:layout_width="20dp"
                        android:layout_height="20dp"
                        android:text="3"
                        android:textSize="12sp"
                        android:textColor="@android:color/white"
                        android:background="#FF5722"
                        android:gravity="center"
                        android:layout_gravity="center_vertical" />
                </LinearLayout>
            </androidx.cardview.widget.CardView>

            <!-- æ¶ˆæ¯é¡¹2 -->
            <androidx.cardview.widget.CardView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="12dp">
                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:orientation="horizontal"
                    android:padding="12dp">
                    <TextView
                        android:layout_width="40dp"
                        android:layout_height="40dp"
                        android:text="ğŸ‘©"
                        android:textSize="30sp"
                        android:gravity="center" />
                    <LinearLayout
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:layout_weight="1"
                        android:orientation="vertical"
                        android:layout_marginLeft="12dp">
                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="æå››"
                            android:textSize="16sp"
                            android:textStyle="bold" />
                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="æ˜å¤©ä¸€èµ·å»åƒé¥­å§"
                            android:textSize="14sp"
                            android:layout_marginTop="4dp" />
                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="æ˜¨å¤©"
                            android:textSize="12sp"
                            android:textColor="#999999"
                            android:layout_marginTop="4dp" />
                    </LinearLayout>
                </LinearLayout>
            </androidx.cardview.widget.CardView>

            <!-- Fragmenté—´ä¼ é€’æ•°æ®æŒ‰é’® -->
            <Button
                android:id="@+id/btn_send_to_mine"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="åœºæ™¯C: å‘é€æ¶ˆæ¯åˆ°æˆ‘çš„é¡µé¢"
                android:layout_marginTop="16dp" />

        </LinearLayout>
    </ScrollView>

</LinearLayout>
```

**MessageFragment ä»£ç **



```java
package com.example.radio;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.Toast;
import androidx.fragment.app.Fragment;

public class MessageFragment extends Fragment {
    
    // Fragmenté€šä¿¡æ¥å£
    public interface OnMessageSendListener {
        void onMessageSend(String message);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_message, container, false);
        
        Button btnSendToMine = view.findViewById(R.id.btn_send_to_mine);
        
        // åœºæ™¯C: Fragment â†’ Fragment é€šè¿‡Activityä¸­è½¬ä¼ é€’æ•°æ®
        btnSendToMine.setOnClickListener(v -> {
            if (getActivity() instanceof MainActivity) {
                MainActivity activity = (MainActivity) getActivity();
                activity.sendMessageToMineFragment("æ¥è‡ªæ¶ˆæ¯é¡µé¢çš„é—®å€™ï¼šä½ å¥½ï¼");
                Toast.makeText(getContext(), "æ¶ˆæ¯å·²å‘é€åˆ°æˆ‘çš„é¡µé¢", Toast.LENGTH_SHORT).show();
            }
        });
        
        return view;
    }
}
```

**4. MineFragment å¸ƒå±€ï¼ˆ**`fragment_mine.xml`**ï¼‰**



```xml
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#FFF3E0">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">

        <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:background="#FF9800"
            android:padding="24dp">

            <TextView
                android:layout_width="80dp"
                android:layout_height="80dp"
                android:text="ğŸ‘¨"
                android:textSize="60sp"
                android:gravity="center"
                android:background="@android:color/white"
                android:layout_gravity="center_horizontal" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="ç”¨æˆ·æ˜µç§°"
                android:textSize="20sp"
                android:textColor="@android:color/white"
                android:textStyle="bold"
                android:layout_gravity="center_horizontal"
                android:layout_marginTop="12dp" />

            <TextView
                android:id="@+id/tv_received_message"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="ä¸ªæ€§ç­¾åï¼šå¿«ä¹æ¯ä¸€å¤©"
                android:textSize="14sp"
                android:textColor="@android:color/white"
                android:layout_gravity="center_horizontal"
                android:layout_marginTop="8dp" />

        </LinearLayout>

        <!-- ç»Ÿè®¡æ•°æ® -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:padding="16dp"
            android:background="@android:color/white">

            <LinearLayout
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:orientation="vertical"
                android:gravity="center">
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="128"
                    android:textSize="20sp"
                    android:textStyle="bold" />
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="å…³æ³¨"
                    android:textSize="14sp"
                    android:textColor="#666666" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:orientation="vertical"
                android:gravity="center">
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="256"
                    android:textSize="20sp"
                    android:textStyle="bold" />
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="ç²‰ä¸"
                    android:textSize="14sp"
                    android:textColor="#666666" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:orientation="vertical"
                android:gravity="center">
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="512"
                    android:textSize="20sp"
                    android:textStyle="bold" />
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="è·èµ"
                    android:textSize="14sp"
                    android:textColor="#666666" />
            </LinearLayout>

        </LinearLayout>

        <!-- è®¾ç½®é€‰é¡¹ -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:layout_marginTop="8dp"
            android:background="@android:color/white"
            android:padding="16dp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="âš™ï¸ è®¾ç½®ä¸ç®¡ç†"
                android:textSize="16sp"
                android:textStyle="bold"
                android:layout_marginBottom="12dp" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ğŸ“ ç¼–è¾‘èµ„æ–™ â€º"
                android:textSize="16sp"
                android:padding="12dp" />

            <View
                android:layout_width="match_parent"
                android:layout_height="1dp"
                android:background="#EEEEEE" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ğŸ”” æ¶ˆæ¯é€šçŸ¥ â€º"
                android:textSize="16sp"
                android:padding="12dp" />

            <View
                android:layout_width="match_parent"
                android:layout_height="1dp"
                android:background="#EEEEEE" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ğŸ”’ éšç§è®¾ç½® â€º"
                android:textSize="16sp"
                android:padding="12dp" />

        </LinearLayout>

        <!-- é€€å‡ºæŒ‰é’® -->
        <Button
            android:id="@+id/btn_logout"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="é€€å‡ºç™»å½•"
            android:layout_margin="16dp"
            android:backgroundTint="#FF5722" />

    </LinearLayout>

</ScrollView>
```

**MineFragment ä»£ç **



```java
package com.example.radio;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;
import androidx.fragment.app.Fragment;

public class MineFragment extends Fragment {
    private TextView tvReceivedMessage;
    private static final String ARG_MESSAGE = "message";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_mine, container, false);
        
        tvReceivedMessage = view.findViewById(R.id.tv_received_message);
        Button btnLogout = view.findViewById(R.id.btn_logout);
        
        // åœºæ™¯B: æ¥æ”¶Activityä¼ é€’çš„æ•°æ®
        Bundle args = getArguments();
        if (args != null) {
            String message = args.getString(ARG_MESSAGE);
            if (message != null) {
                tvReceivedMessage.setText("æ”¶åˆ°çš„æ¶ˆæ¯ï¼š" + message);
            }
        }
        
        // åœºæ™¯B: Fragmentå‘Activityè¿”å›æ•°æ®
        btnLogout.setOnClickListener(v -> {
            if (getActivity() instanceof MainActivity) {
                MainActivity activity = (MainActivity) getActivity();
                activity.onFragmentResult("ç”¨æˆ·ç‚¹å‡»äº†é€€å‡ºç™»å½•");
                Toast.makeText(getContext(), "å·²å‘Activityè¿”å›æ•°æ®", Toast.LENGTH_SHORT).show();
            }
        });
        
        return view;
    }
    
    // åœºæ™¯C: æ›´æ–°æ¥æ”¶åˆ°çš„æ¶ˆæ¯
    public void updateReceivedMessage(String message) {
        if (tvReceivedMessage != null) {
            tvReceivedMessage.setText("æ”¶åˆ°çš„æ¶ˆæ¯ï¼š" + message);
        }
    }
    
    // åˆ›å»ºå®ä¾‹çš„å·¥å‚æ–¹æ³•ï¼ˆåœºæ™¯Bä½¿ç”¨ï¼‰
    public static MineFragment newInstance(String message) {
        MineFragment fragment = new MineFragment();
        Bundle args = new Bundle();
        args.putString(ARG_MESSAGE, message);
        fragment.setArguments(args);
        return fragment;
    }
}
```

#### æ­¥éª¤ 4ï¼šä¿®æ”¹ä¸»å¸ƒå±€å’Œ MainActivity

**ä¸»å¸ƒå±€ï¼ˆ**`activity_main.xml`**ï¼‰**



```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <FrameLayout
        android:id="@+id/fragment_container"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1" />

    <RadioGroup
        android:id="@+id/radio_group"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:gravity="center"
        android:padding="8dp"
        android:background="#EEEEEE">

        <RadioButton
            android:id="@+id/rb_home"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="é¦–é¡µ"
            android:checked="true"
            style="@style/CustomRadioButton"/>

        <RadioButton
            android:id="@+id/rb_discover"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="å‘ç°"
            style="@style/CustomRadioButton"/>

        <RadioButton
            android:id="@+id/rb_message"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="æ¶ˆæ¯"
            style="@style/CustomRadioButton"/>

        <RadioButton
            android:id="@+id/rb_mine"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="æˆ‘çš„"
            style="@style/CustomRadioButton"/>
    </RadioGroup>
</LinearLayout>
```

**MainActivity ä»£ç **



```java
package com.example.radio;

import android.os.Bundle;
import android.util.Log;
import android.widget.RadioGroup;
import android.widget.Toast;
import androidx.annotation.NonNull;
import androidx.appcompat.app.AppCompatActivity;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;

public class MainActivity extends AppCompatActivity {
    private static final String TAG = "RadioFragmentDemo";
    private Fragment homeFragment, discoverFragment, messageFragment, mineFragment;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.d(TAG, "MainActivity - onCreate");
        setContentView(R.layout.activity_main);

        // åˆå§‹åŒ–Fragment
        initFragments();

        // è®¾ç½®RadioGroupç›‘å¬
        RadioGroup radioGroup = findViewById(R.id.radio_group);
        radioGroup.setOnCheckedChangeListener((group, checkedId) -> {
            if (checkedId == R.id.rb_home) {
                switchFragment(homeFragment);
            } else if (checkedId == R.id.rb_discover) {
                switchFragment(discoverFragment);
            } else if (checkedId == R.id.rb_message) {
                switchFragment(messageFragment);
            } else if (checkedId == R.id.rb_mine) {
                switchFragment(mineFragment);
            }
        });

        // é»˜è®¤æ˜¾ç¤ºé¦–é¡µ
        if (savedInstanceState == null) {
            switchFragment(homeFragment);
        }
    }

    private void initFragments() {
        homeFragment = new HomeFragment();
        discoverFragment = new DiscoverFragment();
        messageFragment = new MessageFragment();
        // åœºæ™¯B: Activityå‘Fragmentä¼ é€’åˆå§‹æ•°æ®
        mineFragment = MineFragment.newInstance("æ¥è‡ªMainActivityçš„åˆå§‹åŒ–æ•°æ®");
    }

    private void switchFragment(Fragment fragment) {
        FragmentManager fragmentManager = getSupportFragmentManager();
        FragmentTransaction transaction = fragmentManager.beginTransaction();
        transaction.replace(R.id.fragment_container, fragment);
        transaction.commit();
    }

    // åœºæ™¯C: Fragment â†’ Fragment é€šè¿‡Activityä¸­è½¬
    public void sendMessageToMineFragment(String message) {
        if (mineFragment instanceof MineFragment) {
            ((MineFragment) mineFragment).updateReceivedMessage(message);
            // è‡ªåŠ¨åˆ‡æ¢åˆ°"æˆ‘çš„"é¡µé¢
            switchFragment(mineFragment);
            RadioGroup radioGroup = findViewById(R.id.radio_group);
            radioGroup.check(R.id.rb_mine);
        }
    }

    // åœºæ™¯B: Fragmentå‘Activityè¿”å›å¤„ç†ç»“æœ
    public void onFragmentResult(String result) {
        Log.d(TAG, "æ”¶åˆ°Fragmentè¿”å›çš„æ•°æ®: " + result);
        Toast.makeText(this, "Activityæ”¶åˆ°: " + result, Toast.LENGTH_LONG).show();
    }

    @Override
    protected void onStart() {
        super.onStart();
        Log.d(TAG, "MainActivity - onStart");
    }

    @Override
    protected void onResume() {
        super.onResume();
        Log.d(TAG, "MainActivity - onResume");
    }

    @Override
    protected void onPause() {
        super.onPause();
        Log.d(TAG, "MainActivity - onPause");
    }

    @Override
    protected void onStop() {
        super.onStop();
        Log.d(TAG, "MainActivity - onStop");
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        Log.d(TAG, "MainActivity - onDestroy");
    }

    @Override
    protected void onRestart() {
        super.onRestart();
        Log.d(TAG, "MainActivity - onRestart");
    }

    @Override
    protected void onSaveInstanceState(@NonNull Bundle outState) {
        super.onSaveInstanceState(outState);
        Log.d(TAG, "MainActivity - onSaveInstanceStateï¼ˆåœ¨onStopä¹‹å‰è°ƒç”¨ï¼‰");
    }

    @Override
    protected void onRestoreInstanceState(@NonNull Bundle savedInstanceState) {
        super.onRestoreInstanceState(savedInstanceState);
        Log.d(TAG, "MainActivity - onRestoreInstanceStateï¼ˆåœ¨onStartä¹‹åè°ƒç”¨ï¼‰");
    }
}
```

### ï¼ˆäºŒï¼‰ç¬¬äºŒéƒ¨åˆ†ï¼šBundle æ•°æ®ä¼ è¾“å®ç°

#### åœºæ™¯ A: Activity â†’ Activity æ•°æ®ä¼ é€’

å‡è®¾æ–°å¢ `DetailActivity`ï¼ˆéœ€åœ¨ `AndroidManifest.xml` ä¸­æ³¨å†Œï¼‰ï¼Œä»¥ HomeFragment è§¦å‘è·³è½¬ä¸ºä¾‹ï¼š

**HomeFragment ä¸­æ·»åŠ è·³è½¬é€»è¾‘**



```java
package com.example.radio;

import android.content.Intent;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import androidx.fragment.app.Fragment;

public class HomeFragment extends Fragment {
    private EditText etInput;
    private TextView tvSavedContent;
    private static final String KEY_SAVED_TEXT = "saved_text";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_home, container, false);

        etInput = view.findViewById(R.id.et_input);
        tvSavedContent = view.findViewById(R.id.tv_saved_content);
        Button btnToDetail = view.findViewById(R.id.btn_to_detail);

        // åœºæ™¯A: Activity â†’ Activity æ•°æ®ä¼ é€’
        btnToDetail.setOnClickListener(v -> {
            Intent intent = new Intent(getActivity(), DetailActivity.class);
            intent.putExtra("username", "å¼ ä¸‰");
            intent.putExtra("age", 20);
            intent.putExtra("isStudent", true);
            startActivity(intent);
        });

        // æ¢å¤ä¿å­˜çš„çŠ¶æ€
        if (savedInstanceState != null) {
            String savedText = savedInstanceState.getString(KEY_SAVED_TEXT);
            if (savedText != null && !savedText.isEmpty()) {
                tvSavedContent.setText("å·²æ¢å¤å†…å®¹ï¼š" + savedText);
                etInput.setText(savedText);
            }
        }

        return view;
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        // ä¿å­˜EditTextä¸­çš„å†…å®¹
        String text = etInput.getText().toString();
        outState.putString(KEY_SAVED_TEXT, text);
        android.util.Log.d("HomeFragment", "onSaveInstanceState: ä¿å­˜äº†å†…å®¹ = " + text);
    }
}

```

**DetailActivity æ¥æ”¶æ•°æ®**



```java
package com.example.radio;

import android.content.Intent;
import android.os.Bundle;
import android.widget.TextView;
import androidx.appcompat.app.AppCompatActivity;

public class DetailActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_detail);

        // è·å–ä¼ é€’è¿‡æ¥çš„æ•°æ®
        Intent intent = getIntent();
        String username = intent.getStringExtra("username");
        int age = intent.getIntExtra("age", 0);
        boolean isStudent = intent.getBooleanExtra("isStudent", false);

        // æ˜¾ç¤ºæ•°æ®
        TextView tvInfo = findViewById(R.id.tv_user_info);
        String info = "ç”¨æˆ·ä¿¡æ¯ï¼š\n\n" +
                "ç”¨æˆ·åï¼š" + username + "\n" +
                "å¹´é¾„ï¼š" + age + " å²\n" +
                "èº«ä»½ï¼š" + (isStudent ? "å­¦ç”Ÿ" : "éå­¦ç”Ÿ");
        tvInfo.setText(info);
    }
}


```

## å››ã€å®éªŒç»“æœä¸åˆ†æ

### ï¼ˆä¸€ï¼‰RadioGroup æ§åˆ¶ Fragment åˆ‡æ¢

æˆåŠŸå®ç° 4 ä¸ª RadioButton å¯¹åº” 4 ä¸ª Fragmentï¼ˆHomeã€Discoverã€Messageã€Mineï¼‰çš„åˆ‡æ¢ï¼ŒRadioButton é€‰ä¸­çŠ¶æ€æ ·å¼éš `radio_button_selector.xml` å®šä¹‰ç”Ÿæ•ˆï¼ŒFragment ç•Œé¢é£æ ¼ä¸åŠŸèƒ½åŒºåˆ†æ˜æ˜¾ã€‚

![](./å®éªŒå›¾ç‰‡/PixPin_2025-11-04_15-19-09.png)

![](./å®éªŒå›¾ç‰‡/ç¬¬äºŒé¡µ.png)

![](./å®éªŒå›¾ç‰‡/ç¬¬ä¸‰é¡µ.png)

![](./å®éªŒå›¾ç‰‡/ç¬¬å››é¡µ.png)

### ï¼ˆäºŒï¼‰Bundle æ•°æ®ä¼ è¾“



1. **åœºæ™¯ A**ï¼šMainActivity å‘ DetailActivity ä¼ é€’ç”¨æˆ·åã€ç­‰çº§ç­‰æ•°æ®ï¼Œæ¥æ”¶ç«¯æ­£ç¡®è§£æå¹¶å±•ç¤ºã€‚

   ![](./å®éªŒå›¾ç‰‡/ä¼ é€’ä¿¡æ¯.png)

2. **åœºæ™¯ B**ï¼š**Activity â†” Fragment** MainActivity å‘ Fragment ä¼ é€’åˆå§‹æ•°æ®ï¼ŒFragment å‘ Activity è¿”å›å¤„ç†ç»“æœ

   ![](./å®éªŒå›¾ç‰‡/ä¼ é€’.png)

   ![](./å®éªŒå›¾ç‰‡/åœºæ™¯B.png)

3. **åœºæ™¯ C**ï¼šé€šè¿‡ MainActivity ä¸­è½¬ï¼ŒMessageFragment çš„å¤„ç†ç»“æœæˆåŠŸä¼ é€’åˆ° MineFragment å¹¶å±•ç¤ºä¸ºç³»ç»Ÿé€šçŸ¥ã€‚

   ![](./å®éªŒå›¾ç‰‡/è¿”å›.png)

   ![](./å®éªŒå›¾ç‰‡/é€€å‡º.png)

### ï¼ˆä¸‰ï¼‰å±å¹•æ—‹è½¬ä¸çŠ¶æ€ä¿å­˜



1. `onSaveInstanceState`![](./å®éªŒå›¾ç‰‡/log.png)

2. **çŠ¶æ€æ¢å¤**ï¼šå±å¹•æ—‹è½¬åï¼ŒEditText ä¸­çš„è¾“å…¥å†…å®¹é€šè¿‡ `onSaveInstanceState` ä¿å­˜ï¼Œå¹¶åœ¨ TextView ä¸­æ¢å¤å±•ç¤ºï¼Œæ•°æ®æŒä¹…åŒ–æ•ˆæœç¬¦åˆé¢„æœŸã€‚

   ![](./å®éªŒå›¾ç‰‡/æ—‹è½¬.png)

## äº”ã€å®éªŒæ€»ç»“

æœ¬æ¬¡å®éªŒåŸºäº `com.example.radio` åŒ…ç»“æ„ï¼Œå®Œæˆäº† RadioGroup æ§åˆ¶ Fragment åˆ‡æ¢ã€å¤šåœºæ™¯ Bundle æ•°æ®ä¼ è¾“åŠå±å¹•æ—‹è½¬çŠ¶æ€ä¿å­˜çš„åŠŸèƒ½å®ç°ã€‚é€šè¿‡å¯¹ Fragment ç”Ÿå‘½å‘¨æœŸã€ç»„ä»¶é—´é€šä¿¡æœºåˆ¶çš„å®è·µï¼Œæ·±å…¥ç†è§£äº† Android ä¸­ç•Œé¢æ¨¡å—åŒ–ä¸æ•°æ®æµè½¬çš„æ ¸å¿ƒé€»è¾‘ã€‚

åœ¨è¿‡ç¨‹ä¸­ï¼Œéœ€æ³¨æ„ Fragment åˆ‡æ¢æ—¶çš„çŠ¶æ€ç®¡ç†ã€Bundle æ•°æ®çš„åºåˆ—åŒ–é™åˆ¶ï¼Œä»¥åŠ `onSaveInstanceState` ä¸æŒä¹…åŒ–å­˜å‚¨çš„åŒºåˆ«ï¼ˆå‰è€…ä»…åº”å¯¹é…ç½®å˜åŒ–ï¼Œåè€…éœ€ç»“åˆæ•°æ®åº“æˆ– SharedPreferencesï¼‰ã€‚è¿™äº›çŸ¥è¯†ç‚¹ä¸ºæ„å»ºå¥å£®ã€ç”¨æˆ·ä½“éªŒè‰¯å¥½çš„ Android åº”ç”¨å¥ å®šäº†åŸºç¡€ã€‚

